import{n as S,m as g,r as h,a0 as z,o as R,x as B,w as u,b as C,H as P,d as l,v as s,e as U,W as H,X as M,ae as V,D as j,c as A,a9 as L,Y as O}from"./index-87dc6a3d.js";import{E as W}from"./el-select-a16e320c.js";import{E as X,a as D}from"./el-input-feb6af59.js";import"./el-scrollbar-10e2dddd.js";/* empty css                 */import{E as Y,a as G,b as J}from"./el-table-column-d69f2288.js";import{E as K}from"./el-image-viewer-b78ccc76.js";import{u as T}from"./useHomeStore-e26e6c72.js";import{E as Q}from"./el-overlay-e8d2bcca.js";import{a as Z,E as ee}from"./el-form-item-9887e1f6.js";import{_ as le}from"./UploadBox-ae10d77b.js";import"./strings-31cb2fe7.js";import"./goodsApi-e52c28cf.js";/* empty css                */const te={__name:"CarouselDrawer",props:{drawer:{type:Boolean,default(){return!1}},ifEdit:{type:Boolean,default(){return!1}},carousel:{type:Object}},emits:["update:drawer"],setup(I,{emit:i}){const a=I,w=T(),v=S({get(){return a.drawer},set(o){i("update:drawer",o)}}),d=g(),m=g();let e=h({});z(()=>{a.ifEdit?(e.carouselRank=a.carousel.carouselRank,e.carouselUrl=a.carousel.carouselUrl.replace("http://192.168.1.3:28019",""),e.redirectUrl=a.carousel.redirectUrl,e.carouselId=a.carousel.carouselId):(e.carouselRank="",e.carouselUrl="",e.redirectUrl="",e.carouselId="")});const _=h({carouselRank:[{required:!0,message:"请设置权重等级",trigger:"blur"}],carouselUrl:[{required:!0,message:"请上传图片",trigger:"blur"}],redirectUrl:[{required:!0,message:"请设置跳转链接",trigger:"blur"}]}),E=o=>{console.log("新增"),o&&o.validate(async t=>{if(t)await w.getCarouselAdd({carouselRank:e.carouselRank,carouselUrl:e.carouselUrl,redirectUrl:e.redirectUrl}),console.log(o),k(o),m.value.clear();else return console.log("error submit!"),!1})},x=o=>{console.log("修改"),o&&o.validate(async t=>{if(t)await w.getCarouselEdit({carouselRank:e.carouselRank,carouselUrl:e.carouselUrl,redirectUrl:e.redirectUrl,carouselId:e.carouselId}),console.log(o),k(o),m.value.clear(),i("update:drawer",!1);else return console.log("error submit!"),!1})},k=o=>{o&&o.resetFields()};return(o,t)=>{const y=X,r=Z,n=D,b=ee,f=Q;return R(),B(f,{modelValue:s(v),"onUpdate:modelValue":t[6]||(t[6]=c=>V(v)?v.value=c:null),direction:"rtl","lock-scroll":!1,size:"50%","destroy-on-close":""},{header:u(()=>[C("h4",null,P(`${a.ifEdit?"编辑":"新增"}轮播图信息`),1)]),default:u(()=>[l(b,{ref_key:"ruleFormRef",ref:d,model:s(e),"status-icon":"",rules:s(_),"label-width":"80px",class:"demo-ruleForm"},{default:u(()=>[l(r,{label:"展示权重",prop:"carouselRank"},{default:u(()=>[l(y,{modelValue:s(e).carouselRank,"onUpdate:modelValue":t[0]||(t[0]=c=>s(e).carouselRank=c),modelModifiers:{number:!0},autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(r,{label:"上传图片",prop:"carouselUrl"},{default:u(()=>[l(le,{ref_key:"upload",ref:m,modelValue:s(e).carouselUrl,"onUpdate:modelValue":[t[1]||(t[1]=c=>s(e).carouselUrl=c),t[2]||(t[2]=c=>s(e).carouselUrl=c)]},null,8,["modelValue"])]),_:1}),l(r,{label:"跳转网址",prop:"redirectUrl"},{default:u(()=>[l(y,{modelValue:s(e).redirectUrl,"onUpdate:modelValue":t[3]||(t[3]=c=>s(e).redirectUrl=c),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(r,null,{default:u(()=>[l(n,{type:"primary",onClick:t[4]||(t[4]=c=>a.ifEdit?x(d.value):E(d.value))},{default:u(()=>[U("提交")]),_:1}),H(l(n,{onClick:t[5]||(t[5]=c=>k(d.value))},{default:u(()=>[U("重置")]),_:1},512),[[M,!a.ifEdit]])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}};const re={class:"row1"},ae={class:"row3"},ye={__name:"CarouselPage",setup(I){const i=T();let a=g(),w=g();j(()=>{a.value,w.value=window.getComputedStyle(a.value).height}),window.onresize=()=>{let r=0,n=0;window.getComputedStyle(a.value).boxSizing=="border-box"&&(r=window.getComputedStyle(a.value).paddingTop?window.getComputedStyle(a.value).paddingTop.replace("px",""):0,n=window.getComputedStyle(a.value).paddingBottom?window.getComputedStyle(a.value).paddingBottom.replace("px",""):0),w.value=`${window.getComputedStyle(a.value).height.replace("px","")-r-n}px`,console.log(window.getComputedStyle(a.value).height,r,n,w.value)};const v=g(),d=g(!1),m=g(!1),e=g();let _=h({});const E=()=>{m.value=!0,e.value=!1},x=r=>{m.value=!0,e.value=!0,_.carouselId=r.row.carouselId,_.carouselRank=r.row.carouselRank,_.carouselUrl=r.row.carouselUrl,_.redirectUrl=r.row.redirectUrl},k=r=>{i.getCarouselDelete({ids:[r.row.carouselId]})},o=()=>{d.value&&v.value.getSelectionRows().length&&i.getCarouselDelete({ids:v.value.getSelectionRows().map(r=>r.carouselId)}),d.value=!d.value},t=S({get(){return i.currPage},set(r){i.currPage=r}}),y=S({get(){return i.pageSize},set(r){i.pageSize=r}});return z(async()=>{await i.getCarouselList(t.value,y.value)}),(r,n)=>{const b=D,f=Y,c=K,$=G,N=J,q=W;return R(),A(O,null,[C("div",re,[l(b,{onClick:E,type:"primary"},{default:u(()=>[U("新增")]),_:1}),l(b,{onClick:o,type:d.value?"danger":"default"},{default:u(()=>[U(P(d.value?"批量删除/取消批量操作":"批量操作"),1)]),_:1},8,["type"])]),C("div",{ref_key:"tableContainerRef",ref:a,class:"row2"},[l(N,{ref_key:"multipleTableRef",ref:v,stripe:"",border:"",height:s(w),style:{width:"100%","text-align":"center"},data:s(i).carouselList,"row-key":"carouselId"},{empty:u(()=>[l($,{description:"加载中"})]),default:u(()=>[d.value?(R(),B(f,{key:0,type:"selection","min-width":"55px","reserve-selection":"",fixed:""})):L("",!0),l(f,{type:"index","min-width":"70px",label:"序号",fixed:""}),l(f,{label:"ID","min-width":"70px",property:"carouselId"}),l(f,{label:"图片展示","min-width":"300px"},{default:u(p=>[l(c,{style:{width:"200px",height:"100px"},src:p.row.carouselUrl,fit:"contain","hide-on-click-modal":!0,lazy:"","preview-src-list":[p.row.carouselUrl]},null,8,["src","preview-src-list"])]),_:1}),l(f,{property:"carouselRank",label:"展示权重","min-width":"120px","show-overflow-tooltip":"",sortable:""}),l(f,{label:"操作","min-width":"150px",fixed:"right"},{default:u(p=>[l(b,{disabled:!!d.value,size:"default",onClick:F=>x(p)},{default:u(()=>[U("编辑")]),_:2},1032,["disabled","onClick"]),l(b,{disabled:!!d.value,size:"default",type:"danger",onClick:F=>k(p),style:{margin:"12px 0"}},{default:u(()=>[U("删除")]),_:2},1032,["disabled","onClick"])]),_:1})]),_:1},8,["height","data"])],512),C("div",ae,[l(q,{currentPage:s(t),"onUpdate:currentPage":n[0]||(n[0]=p=>V(t)?t.value=p:null),pageSize:s(y),"onUpdate:pageSize":n[1]||(n[1]=p=>V(y)?y.value=p:null),"page-sizes":[10,15,20],layout:"total, sizes, prev, pager, next, jumper",total:s(i).totalCount,"page-count":s(i).totalPage},null,8,["currentPage","pageSize","total","page-count"])]),l(te,{drawer:m.value,"onUpdate:drawer":n[2]||(n[2]=p=>m.value=p),"onUpdata:drawer":n[3]||(n[3]=p=>m.value=p),ifEdit:e.value,carousel:s(_)},null,8,["drawer","ifEdit","carousel"])],64)}}};export{ye as default};
