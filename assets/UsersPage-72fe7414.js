import{ai as P,aj as B,ak as x,m as w,D as L,n as b,a0 as N,o as S,c as R,b as y,d as o,w as g,e as h,H as m,W as k,X as C,x as $,a9 as I,v as p,ae as T,Y as D}from"./index-87dc6a3d.js";import{E as V}from"./el-select-a16e320c.js";import{a as j}from"./el-input-feb6af59.js";import"./el-scrollbar-10e2dddd.js";import{b as H,E as M,a as O}from"./el-table-column-d69f2288.js";import"./strings-31cb2fe7.js";function W(d={}){return P({url:"/manage-api/v1/users",method:"get",params:d})}function X(d,a={}){return P({url:`/manage-api/v1/users/${d}`,method:"put",data:a})}const Y=B("users",{state:()=>({usersList:[],usersPage:1,usersSize:10,usersCount:0,usersTotalPage:0,lockedFlag:""}),actions:{getUsersList(d,a,e){const u={};return u.pageNumber=d,u.pageSize=a,e==""||(u.lockedFlag=e),W(u).then(n=>{n.status==200?n.data.resultCode==200?(console.log("获取用户列表成功---"),this.usersList=n.data.data.list,this.usersCount=n.data.data.totalCount,this.usersTotalPage=n.data.data.totalPage):console.log("获取用户列表失败---",n.data.message):console.log("请求获取用户列表失败---",n)})},getUsersToggle(d,a){return X(d,a).then(e=>{e.status==200?e.data.resultCode==200?(console.log("修改用户状态成功---"),x.success({message:e.data.message}),this.getUsersList(this.usersPage,this.usersSize,this.lockedFlag)):(x.error({message:e.data.message}),console.log("修改用户状态失败---",e.data.message)):console.log("请求修改用户状态失败---",e)})}}});const q={class:"row1"},A={class:"row3"},ae={__name:"UsersPage",setup(d){const a=Y();let e=w(),u=w();L(()=>{e.value,u.value=window.getComputedStyle(e.value).height}),window.onresize=()=>{let s=0,t=0;window.getComputedStyle(e.value).boxSizing=="border-box"&&(s=window.getComputedStyle(e.value).paddingTop?window.getComputedStyle(e.value).paddingTop.replace("px",""):0,t=window.getComputedStyle(e.value).paddingBottom?window.getComputedStyle(e.value).paddingBottom.replace("px",""):0),u.value=`${window.getComputedStyle(e.value).height.replace("px","")-s-t}px`,console.log(window.getComputedStyle(e.value).height,s,t,u.value)};const n=w(),i=w(!1),z=s=>{a.getUsersToggle(s.row.lockedFlag?0:1,{ids:[s.row.userId]})},_=s=>{i.value&&n.value.getSelectionRows().length&&a.getUsersToggle(s,{ids:n.value.getSelectionRows().map(t=>t.userId)}),i.value=!i.value},U=(s,t,c)=>{const r=c.property;return t[r]===s},f=b({get(){return a.usersPage},set(s){a.usersPage=s}}),v=b({get(){return a.usersSize},set(s){a.usersSize=s}});return N(async()=>{await a.getUsersList(f.value,v.value,a.lockedFlag)}),(s,t)=>{const c=j,r=M,E=O,F=V;return S(),R(D,null,[y("div",q,[o(c,{onClick:t[0]||(t[0]=l=>i.value=!i.value),type:"default"},{default:g(()=>[h(m(i.value?"取消批量操作":"批量操作"),1)]),_:1}),k(o(c,{onClick:t[1]||(t[1]=l=>_(0)),type:"success"},{default:g(()=>[h(m("激活"))]),_:1},512),[[C,i.value]]),k(o(c,{onClick:t[2]||(t[2]=l=>_(1)),type:"danger"},{default:g(()=>[h(m("锁定"))]),_:1},512),[[C,i.value]])]),y("div",{ref_key:"tableContainerRef",ref:e,class:"row2"},[o(p(H),{ref_key:"multipleTableRef",ref:n,stripe:"",border:"",height:p(u),style:{width:"100%","text-align":"center"},data:p(a).usersList,"row-key":"userId"},{empty:g(()=>[o(E,{description:"加载中"})]),default:g(()=>[i.value?(S(),$(r,{key:0,type:"selection","min-width":"55px","reserve-selection":"",fixed:""})):I("",!0),o(r,{type:"index","min-width":"55px",label:"序号",fixed:""}),o(r,{label:"ID","min-width":"50px",property:"userId"}),o(r,{label:"登录名","min-width":"150px",property:"loginName"}),o(r,{label:"昵称","min-width":"150px",property:"nickName"}),o(r,{label:"简介","min-width":"200px",property:"introduceSign"}),o(r,{label:"创建时间","min-width":"200px",property:"createTime"}),o(r,{property:"lockedFlag",label:"用户状态","min-width":"120","show-overflow-tooltip":"","column-key":"8",filters:[{text:"已禁用",value:1},{text:"使用中",value:0}],"filter-method":U},{default:g(l=>[y("span",null,m(l.row.lockedFlag?"已禁用":"使用中"),1)]),_:1}),o(r,{label:"操作",fixed:"right","min-width":"100px"},{default:g(l=>[o(c,{disabled:!!i.value,size:"default",type:l.row.lockedFlag?"success":"danger",onClick:G=>z(l)},{default:g(()=>[h(m(l.row.lockedFlag?"激活":"禁用"),1)]),_:2},1032,["disabled","type","onClick"])]),_:1})]),_:1},8,["height","data"])],512),y("div",A,[o(F,{currentPage:p(f),"onUpdate:currentPage":t[3]||(t[3]=l=>T(f)?f.value=l:null),pageSize:p(v),"onUpdate:pageSize":t[4]||(t[4]=l=>T(v)?v.value=l:null),"page-sizes":[10,15,20],layout:"total, sizes, prev, pager, next, jumper",total:p(a).usersCount,"page-count":p(a).usersTotalPage},null,8,["currentPage","pageSize","total","page-count"])])],64)}}};export{ae as default};
